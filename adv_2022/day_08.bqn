ToInt←10⊸×⊸+˜´∘⌽-⟜'0'
Vis←∊∧≥⟜(⌈`)
VisX←{>(Vis∨Vis⌾⌽)¨<˘𝕩}
P1←{+´+˝(VisX∨VisX⌾⍉)𝕩}
Dist←{x‿xs:0⊸<∘≠◶⟨0,({(≠xs)=𝕩}◶⟨1⊸+,⊢⟩⊑0⊐˜x>xs)⟩xs}
Right←{<∘⌽˘⍉({1↓↓𝕩}≍⊢)𝕩}
Left←{<∘⌽˘⍉({¯1↓↑𝕩}(⌽¨)⊸≍⊢)𝕩}
P2←{⌈´⥊{(>{(Dist¨Left 𝕩)×(Dist¨Right𝕩)}¨<˘𝕩)×(⍉>{(Dist¨Left 𝕩)×(Dist¨Right𝕩)}¨<˘⍉𝕩)}𝕩}
input←ToInt∘≍¨>•Flines"input_08.txt"
•Show P1 input
•Show P2 input
